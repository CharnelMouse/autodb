<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Handling missing values • autodb</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Handling missing values">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">autodb</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">3.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/autodb.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/limits.html">Limitations</a></li>
    <li><a class="dropdown-item" href="../articles/nudge.html">A larger example: the nudge dataset</a></li>
    <li><a class="dropdown-item" href="../articles/null.html">Handling missing values</a></li>
    <li><a class="dropdown-item" href="../articles/plans.html">Planned improvements</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CharnelMouse/autodb/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="null_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="null_files/viz-1.8.2/viz.js"></script><link href="null_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="null_files/grViz-binding-1.0.11/grViz.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Handling missing values</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CharnelMouse/autodb/blob/master/vignettes/null.Rmd" class="external-link"><code>vignettes/null.Rmd</code></a></small>
      <div class="d-none name"><code>null.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://charnelmouse.github.io/autodb/">autodb</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'autodb'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     decompose</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"DiagrammeR"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">show</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">DiagrammeR</span><span class="fu">::</span><span class="fu"><a href="https://rich-iannone.github.io/DiagrammeR/reference/grViz.html" class="external-link">grViz</a></span><span class="op">(</span><span class="fu"><a href="../reference/gv.html">gv</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span></span>
<span>  <span class="va">maybe_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">DiagrammeR</span><span class="fu">::</span><span class="fu"><a href="https://rich-iannone.github.io/DiagrammeR/reference/grViz.html" class="external-link">grViz</a></span><span class="op">(</span><span class="fu"><a href="../reference/gv.html">gv</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>  <span class="va">show</span> <span class="op">&lt;-</span> <span class="va">print</span></span>
<span>  <span class="va">maybe_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level2">
<h2 id="missing-values">Missing values<a class="anchor" aria-label="anchor" href="#missing-values"></a>
</h2>
<p>Strictly speaking, <code>autodb</code> does not search for functional
dependencies, because these can’t account for missing values. Instead,
it searches for a weaker variant, which has been called a
<em>literal</em> functional dependency (LFD) in the literature.</p>
<p>The functional dependency <code>X -&gt; Y</code> holds if, for any
two possible records whose values in <code>X</code> are <em>equal</em>,
their values in <code>Y</code> are also <em>equal</em>. This requires
attribute values to take the <em>equality</em> operator, <code>==</code>
in R. Additionally, they must take it under binary logic: whether two
values are equal can only be true or false, not missing. This disallows
the presence of missing values (<code>NA</code> and <code>NaN</code>),
since testing for equality with a missing value returns a missing
result.</p>
<p>The literal functional dependency <code>X -&gt; Y</code> holds – or
the functional dependency <code>X -&gt; Y</code> holds literally – if,
for any two possible records whose values in <code>X</code> are
<em>identical</em>, their values in <code>Y</code> are also
<em>identical</em>. In other words, missing values are treated as only
equal to each other. This requires attribute classes to take the
<em>identity</em> operator, <code><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical()</a></code> with default
optional parameter values in R. This can only return <code>TRUE</code>
or <code>FALSE</code>, never <code>NA</code>, so there is no constraint
on having missing values.</p>
<p>LFDs are more generic than standard FDs: since practically every
class takes the identity operator, they practically make no assumptions
about the attribute classes present in a data set, so we can use them on
just about anything.</p>
<p>There are other FD variants that handle missing values, but, unlike
most of them, LFDs still satisfy Armstrong’s axioms, allowing them to be
used in normalisation in the same way as normal FDs. For example, they
still respect transitivity: if X -&gt; Y and Y -&gt; Z literally, then X
-&gt; Z literally. This allows us to construct a database schema with
Bernstein synthesis, as usual, and still get something coherent.</p>
</div>
<div class="section level2">
<h2 id="decomposing-to-remove-missing-values">Decomposing to remove missing values<a class="anchor" aria-label="anchor" href="#decomposing-to-remove-missing-values"></a>
</h2>
<p>However, ignoring the special status of missing values in this way
ignores important structural information. In the relational model, and
ideally in relational databases, we want to have no missing values at
all, partly to avoid awkward questions about how to handle missing
values when filtering or joining relations.</p>
<p>For example, take the following data frame:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_nas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  patient <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">3L</span>, <span class="fl">4L</span><span class="op">)</span>,</span>
<span>  trial_entry_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2022/05/02"</span>, <span class="st">"2022/06/06"</span>, <span class="st">"2022/04/01"</span>, <span class="st">"2022/03/19"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  trial_exit_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"2022/10/07"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">df_nas</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">patient</th>
<th align="left">trial_entry_date</th>
<th align="left">trial_exit_date</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">2022-05-02</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">2022-06-06</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">2022-04-01</td>
<td align="left">2022-10-07</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">2022-03-19</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p><code>autodb</code> currently treats <code>NA</code> as just another
value, so the data is all kept together in the database schema:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">show</span><span class="op">(</span><span class="fu"><a href="../reference/autodb.html">autodb</a></span><span class="op">(</span><span class="va">df_nas</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"patient\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"4\">patient (4 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_patient\">patient<\/TD><TD BGCOLOR=\"black\"><\/TD><TD><\/TD><TD PORT=\"FROM_patient\">integer<\/TD><\/TR>\n    <TR><TD PORT=\"TO_trial_entry_date\">trial_entry_date<\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_trial_entry_date\">Date<\/TD><\/TR>\n    <TR><TD PORT=\"TO_trial_exit_date\">trial_exit_date<\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_trial_exit_date\">Date<\/TD><\/TR>\n    <\/TABLE>>];\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>In this case, a missing exit date represents no exit date, i.e. that
the patient is still in the trial. To make this difference explicit –
and enforced – we would move exit information to a separate relation,
containing only patients with a exit date. Removing missing values in
this way isn’t handled by <code>autodb</code> itself, so it has to be
done by manually creating the schema and inserting records:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds_trial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/database_schema.html">database_schema</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/relation_schema.html">relation_schema</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      patient <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patient"</span>, <span class="st">"trial_entry_date"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"patient"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      patient_exit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patient"</span>, <span class="st">"trial_exit_date"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"patient"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_nas</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"patient_exit"</span>, <span class="st">"patient"</span>, <span class="st">"patient"</span>, <span class="st">"patient"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># approach 1: decompose, then remove</span></span>
<span><span class="va">ideal_db</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decompose.html">decompose</a></span><span class="op">(</span><span class="va">df_nas</span>, <span class="va">ds_trial</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/records.html">records</a></span><span class="op">(</span><span class="va">ideal_db</span><span class="op">)</span><span class="op">$</span><span class="va">patient_exit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/records.html">records</a></span><span class="op">(</span><span class="va">ideal_db</span><span class="op">)</span><span class="op">$</span><span class="va">patient_exit</span>,</span>
<span>  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">trial_exit_date</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># approach 2: create and insert</span></span>
<span><span class="va">ideal_db2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create.html">create</a></span><span class="op">(</span><span class="va">ds_trial</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/insert.html">insert</a></span><span class="op">(</span><span class="va">df_nas</span>, relations <span class="op">=</span> <span class="st">"patient"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/insert.html">insert</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">df_nas</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">trial_exit_date</span><span class="op">)</span><span class="op">)</span>, relations <span class="op">=</span> <span class="st">"patient_exit"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">ideal_db2</span>, <span class="va">ideal_db</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">ideal_db</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"patient\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">patient (4 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_patient\">patient<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_patient\">integer<\/TD><\/TR>\n    <TR><TD PORT=\"TO_trial_entry_date\">trial_entry_date<\/TD><TD><\/TD><TD PORT=\"FROM_trial_entry_date\">Date<\/TD><\/TR>\n    <\/TABLE>>];\n  \"patient_exit\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">patient_exit (1 record)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_patient\">patient<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_patient\">integer<\/TD><\/TR>\n    <TR><TD PORT=\"TO_trial_exit_date\">trial_exit_date<\/TD><TD><\/TD><TD PORT=\"FROM_trial_exit_date\">Date<\/TD><\/TR>\n    <\/TABLE>>];\n\n  \"patient_exit\":FROM_patient -> \"patient\":TO_patient;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="structure-conditional-on-value-presence">Structure conditional on value presence<a class="anchor" aria-label="anchor" href="#structure-conditional-on-value-presence"></a>
</h2>
<p>Sometimes, the structure for some attributes depends on whether other
attributes are missing. Here are two possible reasons:</p>
<ul>
<li>A set of attributes are missing or non-missing together.</li>
<li>Sets of attributes are mutually exclusive. This is common when
different records represent different types of observation, and so use
different attributes. The sets might not be disjoint.</li>
</ul>
<p>For example, the data below records values, and allows them to be
single values, or an interval with an associated distribution, which may
have some distribution parameters. This format is common when listing
model parameters.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.3</span>, <span class="fl">2.3</span>, <span class="fl">5.7</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span><span class="op">)</span>,</span>
<span>  lower_bound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="fl">2.4</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">5.6</span>, <span class="fl">2.4</span>, <span class="fl">5.3</span>, <span class="fl">5.3</span>, <span class="fl">2.4</span>, <span class="fl">2.4</span>, <span class="fl">2.4</span>, <span class="fl">2.4</span>, <span class="fl">2.4</span>, <span class="fl">2.4</span>, <span class="fl">2.4</span>, <span class="fl">5.6</span>, <span class="fl">2.4</span><span class="op">)</span>,</span>
<span>  upper_bound <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="cn">NA_real_</span>, <span class="fl">7.1</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">13.1</span>, <span class="fl">25.8</span>, <span class="fl">10</span>, <span class="fl">13.1</span>, <span class="fl">10</span>, <span class="fl">25.8</span>, <span class="fl">25.8</span>, <span class="fl">25.8</span>, <span class="fl">25.8</span>,<span class="fl">13.1</span>, <span class="fl">13.1</span>, <span class="fl">25.8</span>, <span class="fl">25.8</span>, <span class="fl">25.8</span><span class="op">)</span>,</span>
<span>  interval_distribution <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"uniform"</span>, <span class="st">"uniform"</span>, <span class="st">"uniform"</span>, <span class="st">"uniform"</span>, <span class="st">"uniform"</span>, <span class="st">"Beta"</span>, <span class="st">"Beta"</span>, <span class="st">"Beta"</span>, <span class="st">"Beta"</span>, <span class="st">"Kumaraswamy"</span>, <span class="st">"Kumaraswamy"</span>, <span class="st">"Kumaraswamy"</span>, <span class="st">"Kumaraswamy"</span>, <span class="st">"PERT"</span>, <span class="st">"PERT"</span>, <span class="st">"PERT"</span>, <span class="st">"PERT"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  param1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2.1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  param2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">df_options</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="4%">
<col width="8%">
<col width="17%">
<col width="17%">
<col width="31%">
<col width="10%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="right">id</th>
<th align="right">value</th>
<th align="right">lower_bound</th>
<th align="right">upper_bound</th>
<th align="left">interval_distribution</th>
<th align="right">param1</th>
<th align="right">param2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2.3</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2.3</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">5.7</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">NA</td>
<td align="right">2.4</td>
<td align="right">7.1</td>
<td align="left">uniform</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">NA</td>
<td align="right">0.0</td>
<td align="right">10.0</td>
<td align="left">uniform</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">NA</td>
<td align="right">1.0</td>
<td align="right">10.0</td>
<td align="left">uniform</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">NA</td>
<td align="right">0.0</td>
<td align="right">13.1</td>
<td align="left">uniform</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">NA</td>
<td align="right">5.6</td>
<td align="right">25.8</td>
<td align="left">uniform</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">NA</td>
<td align="right">2.4</td>
<td align="right">10.0</td>
<td align="left">Beta</td>
<td align="right">1.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">NA</td>
<td align="right">5.3</td>
<td align="right">13.1</td>
<td align="left">Beta</td>
<td align="right">1.0</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">NA</td>
<td align="right">5.3</td>
<td align="right">10.0</td>
<td align="left">Beta</td>
<td align="right">1.0</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">NA</td>
<td align="right">2.4</td>
<td align="right">25.8</td>
<td align="left">Beta</td>
<td align="right">2.0</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">NA</td>
<td align="right">2.4</td>
<td align="right">25.8</td>
<td align="left">Kumaraswamy</td>
<td align="right">2.0</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">NA</td>
<td align="right">2.4</td>
<td align="right">25.8</td>
<td align="left">Kumaraswamy</td>
<td align="right">2.1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">NA</td>
<td align="right">2.4</td>
<td align="right">25.8</td>
<td align="left">Kumaraswamy</td>
<td align="right">2.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">NA</td>
<td align="right">2.4</td>
<td align="right">13.1</td>
<td align="left">Kumaraswamy</td>
<td align="right">2.0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">NA</td>
<td align="right">2.4</td>
<td align="right">13.1</td>
<td align="left">PERT</td>
<td align="right">2.0</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">NA</td>
<td align="right">2.4</td>
<td align="right">25.8</td>
<td align="left">PERT</td>
<td align="right">1.0</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">NA</td>
<td align="right">5.6</td>
<td align="right">25.8</td>
<td align="left">PERT</td>
<td align="right">2.0</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">NA</td>
<td align="right">2.4</td>
<td align="right">25.8</td>
<td align="left">PERT</td>
<td align="right">2.0</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>Since <code>autodb</code> doesn’t treat missing values as a special
case, it can not detect these relationships so the resulting schema
ignores them:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autodb.html">autodb</a></span><span class="op">(</span><span class="va">df_options</span><span class="op">)</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">db_options</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-36aa3d2a04d42bbc2145" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"id\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">id (20 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_id\">id<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_id\">integer<\/TD><\/TR>\n    <TR><TD PORT=\"TO_value\">value<\/TD><TD><\/TD><TD PORT=\"FROM_value\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_lower_bound\">lower_bound<\/TD><TD><\/TD><TD PORT=\"FROM_lower_bound\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_upper_bound\">upper_bound<\/TD><TD><\/TD><TD PORT=\"FROM_upper_bound\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_interval_distribution\">interval_distribution<\/TD><TD><\/TD><TD PORT=\"FROM_interval_distribution\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param1\">param1<\/TD><TD><\/TD><TD PORT=\"FROM_param1\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param2\">param2<\/TD><TD><\/TD><TD PORT=\"FROM_param2\">numeric<\/TD><\/TR>\n    <\/TABLE>>];\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>However, from looking at the data ourselves, we can see a
clearly-implied structure:</p>
<ul>
<li>A record either has a perfectly-known value, or a distribution of
what the value could be. These two options have separate
attributes.</li>
<li>Distribution information contains a lower and upper bound, and a
distribution type. Different distributions have different numbers of
distribution parameters, which are given in shared parameter
attributes.</li>
<li>Parameter attributes are ordered: there can only be a second
parameter if there’s a first parameter.</li>
</ul>
<p>As a general hack for finding these sorts of relationships, I like
taking each attribute with missing values, and adding a presence
indicator attribute, that states whether its value is present or
missing:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_options_presence</span> <span class="op">&lt;-</span> <span class="va">df_options</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">df_options</span>, <span class="va">anyNA</span>, <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">df_options_presence</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">df_options_presence</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Negate</a></span><span class="op">(</span><span class="va">is.na</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_options_presence</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_options_presence</span><span class="op">)</span>, <span class="st">"_present"</span><span class="op">)</span></span>
<span><span class="va">df_options_with_presence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">df_options</span>, <span class="va">df_options_presence</span><span class="op">)</span></span></code></pre></div>
<p>This is not always practical, because adding columns rapidly
increases the running time for the dependency search. In this case,
running time is not an issue, and it makes the structure in the database
schema more apparent:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_options_with_presence</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autodb.html">autodb</a></span><span class="op">(</span><span class="va">df_options_with_presence</span><span class="op">)</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">db_options_with_presence</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-febe03efa1a2d8d52a86" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"id\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">id (20 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_id\">id<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_id\">integer<\/TD><\/TR>\n    <TR><TD PORT=\"TO_value\">value<\/TD><TD><\/TD><TD PORT=\"FROM_value\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_lower_bound\">lower_bound<\/TD><TD><\/TD><TD PORT=\"FROM_lower_bound\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_upper_bound\">upper_bound<\/TD><TD><\/TD><TD PORT=\"FROM_upper_bound\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_interval_distribution\">interval_distribution<\/TD><TD><\/TD><TD PORT=\"FROM_interval_distribution\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param1\">param1<\/TD><TD><\/TD><TD PORT=\"FROM_param1\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param2\">param2<\/TD><TD><\/TD><TD PORT=\"FROM_param2\">numeric<\/TD><\/TR>\n    <\/TABLE>>];\n  \"value\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">value (3 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_value\">value<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_value\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_value_present\">value_present<\/TD><TD><\/TD><TD PORT=\"FROM_value_present\">logical<\/TD><\/TR>\n    <\/TABLE>>];\n  \"lower_bound\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">lower_bound (6 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_lower_bound\">lower_bound<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_lower_bound\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_value_present\">value_present<\/TD><TD><\/TD><TD PORT=\"FROM_value_present\">logical<\/TD><\/TR>\n    <\/TABLE>>];\n  \"upper_bound\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">upper_bound (5 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_upper_bound\">upper_bound<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_upper_bound\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_value_present\">value_present<\/TD><TD><\/TD><TD PORT=\"FROM_value_present\">logical<\/TD><\/TR>\n    <\/TABLE>>];\n  \"interval_distribution\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">interval_distribution (5 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_interval_distribution\">interval_distribution<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_interval_distribution\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_value_present\">value_present<\/TD><TD><\/TD><TD PORT=\"FROM_value_present\">logical<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param1_present\">param1_present<\/TD><TD><\/TD><TD PORT=\"FROM_param1_present\">logical<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param2_present\">param2_present<\/TD><TD><\/TD><TD PORT=\"FROM_param2_present\">logical<\/TD><\/TR>\n    <\/TABLE>>];\n  \"param1\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">param1 (4 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param1\">param1<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_param1\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param1_present\">param1_present<\/TD><TD><\/TD><TD PORT=\"FROM_param1_present\">logical<\/TD><\/TR>\n    <\/TABLE>>];\n  \"param2\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">param2 (3 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param2\">param2<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_param2\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param2_present\">param2_present<\/TD><TD><\/TD><TD PORT=\"FROM_param2_present\">logical<\/TD><\/TR>\n    <\/TABLE>>];\n  \"value_present\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"6\">value_present (2 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_value_present\">value_present<\/TD><TD BGCOLOR=\"black\"><\/TD><TD><\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_value_present\">logical<\/TD><\/TR>\n    <TR><TD PORT=\"TO_lower_bound_present\">lower_bound_present<\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_lower_bound_present\">logical<\/TD><\/TR>\n    <TR><TD PORT=\"TO_upper_bound_present\">upper_bound_present<\/TD><TD><\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD><\/TD><TD PORT=\"FROM_upper_bound_present\">logical<\/TD><\/TR>\n    <TR><TD PORT=\"TO_interval_distribution_present\">interval_distribution_present<\/TD><TD><\/TD><TD><\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_interval_distribution_present\">logical<\/TD><\/TR>\n    <\/TABLE>>];\n\n  \"id\":FROM_value -> \"value\":TO_value;\n  \"id\":FROM_lower_bound -> \"lower_bound\":TO_lower_bound;\n  \"id\":FROM_upper_bound -> \"upper_bound\":TO_upper_bound;\n  \"id\":FROM_interval_distribution -> \"interval_distribution\":TO_interval_distribution;\n  \"id\":FROM_param1 -> \"param1\":TO_param1;\n  \"id\":FROM_param2 -> \"param2\":TO_param2;\n  \"value\":FROM_value_present -> \"value_present\":TO_value_present;\n  \"lower_bound\":FROM_value_present -> \"value_present\":TO_value_present;\n  \"upper_bound\":FROM_value_present -> \"value_present\":TO_value_present;\n  \"interval_distribution\":FROM_value_present -> \"value_present\":TO_value_present;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Some of the new information is trivially true: attributes always
determine their own presence. Of more interest is the
<code>value_present</code> relation, which shows that the values,
bounds, and interval distributions inform the presence of each
other:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/records.html">records</a></span><span class="op">(</span><span class="va">db_options_with_presence</span><span class="op">)</span><span class="op">$</span><span class="va">value_present</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="3%">
<col width="16%">
<col width="22%">
<col width="22%">
<col width="34%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">value_present</th>
<th align="left">lower_bound_present</th>
<th align="left">upper_bound_present</th>
<th align="left">interval_distribution_present</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>In the <code>interval_distribution</code> relation, we can also see
how the interval distribution determines how many parameters are
required:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/records.html">records</a></span><span class="op">(</span><span class="va">db_options_with_presence</span><span class="op">)</span><span class="op">$</span><span class="va">interval_distribution</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="4%">
<col width="31%">
<col width="20%">
<col width="21%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">interval_distribution</th>
<th align="left">value_present</th>
<th align="left">param1_present</th>
<th align="left">param2_present</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">NA</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">uniform</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">Beta</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">13</td>
<td align="left">Kumaraswamy</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">17</td>
<td align="left">PERT</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>We can use this enhanced database to decide how to manually split up
the actual database.</p>
<p>If we want to go further, then the last set of records above shows an
additional existence constraint not found by the search: if
<code>param2</code> is present, then <code>param1</code> is also
present. If we notice a constraint like this, then we can attempt
further investigation by splitting the data based on it, and passing
each part into <code>autodb</code> separately. We get the following
database for records where <code>param1</code> is absent:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_options_with_presence_p1absent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autodb.html">autodb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span>
<span>  <span class="va">df_options_with_presence</span>,</span>
<span>  <span class="op">!</span><span class="va">param1_present</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">db_options_with_presence_p1absent</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-1fb4450895fe099f74a1" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"constants\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">constants (1 record)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param1\">param1<\/TD><TD><\/TD><TD PORT=\"FROM_param1\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param2\">param2<\/TD><TD><\/TD><TD PORT=\"FROM_param2\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param1_present\">param1_present<\/TD><TD><\/TD><TD PORT=\"FROM_param1_present\">logical<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param2_present\">param2_present<\/TD><TD><\/TD><TD PORT=\"FROM_param2_present\">logical<\/TD><\/TR>\n    <\/TABLE>>];\n  \"id\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">id (8 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_id\">id<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_id\">integer<\/TD><\/TR>\n    <TR><TD PORT=\"TO_value\">value<\/TD><TD><\/TD><TD PORT=\"FROM_value\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_lower_bound\">lower_bound<\/TD><TD><\/TD><TD PORT=\"FROM_lower_bound\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_upper_bound\">upper_bound<\/TD><TD><\/TD><TD PORT=\"FROM_upper_bound\">numeric<\/TD><\/TR>\n    <\/TABLE>>];\n  \"value\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">value (3 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_value\">value<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_value\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_interval_distribution\">interval_distribution<\/TD><TD><\/TD><TD PORT=\"FROM_interval_distribution\">factor<\/TD><\/TR>\n    <\/TABLE>>];\n  \"lower_bound\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">lower_bound (5 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_lower_bound\">lower_bound<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_lower_bound\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_interval_distribution\">interval_distribution<\/TD><TD><\/TD><TD PORT=\"FROM_interval_distribution\">factor<\/TD><\/TR>\n    <\/TABLE>>];\n  \"upper_bound\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">upper_bound (5 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_upper_bound\">upper_bound<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_upper_bound\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_interval_distribution\">interval_distribution<\/TD><TD><\/TD><TD PORT=\"FROM_interval_distribution\">factor<\/TD><\/TR>\n    <\/TABLE>>];\n  \"interval_distribution\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"7\">interval_distribution (2 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_interval_distribution\">interval_distribution<\/TD><TD BGCOLOR=\"black\"><\/TD><TD><\/TD><TD><\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_interval_distribution\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_value_present\">value_present<\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD><\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_value_present\">logical<\/TD><\/TR>\n    <TR><TD PORT=\"TO_lower_bound_present\">lower_bound_present<\/TD><TD><\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_lower_bound_present\">logical<\/TD><\/TR>\n    <TR><TD PORT=\"TO_upper_bound_present\">upper_bound_present<\/TD><TD><\/TD><TD><\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD><\/TD><TD PORT=\"FROM_upper_bound_present\">logical<\/TD><\/TR>\n    <TR><TD PORT=\"TO_interval_distribution_present\">interval_distribution_present<\/TD><TD><\/TD><TD><\/TD><TD><\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_interval_distribution_present\">logical<\/TD><\/TR>\n    <\/TABLE>>];\n\n  \"id\":FROM_value -> \"value\":TO_value;\n  \"id\":FROM_lower_bound -> \"lower_bound\":TO_lower_bound;\n  \"id\":FROM_upper_bound -> \"upper_bound\":TO_upper_bound;\n  \"value\":FROM_interval_distribution -> \"interval_distribution\":TO_interval_distribution;\n  \"lower_bound\":FROM_interval_distribution -> \"interval_distribution\":TO_interval_distribution;\n  \"upper_bound\":FROM_interval_distribution -> \"interval_distribution\":TO_interval_distribution;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Due to the existence constraint mentioned above, <code>param2</code>
is constant, since it’s always absent:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/records.html">records</a></span><span class="op">(</span><span class="va">db_options_with_presence_p1absent</span><span class="op">)</span><span class="op">$</span><span class="va">constants</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">param1</th>
<th align="right">param2</th>
<th align="left">param1_present</th>
<th align="left">param2_present</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr></tbody>
</table>
<p>Additionally, this database only contains records for point
estimates, or intervals with a uniform distribution. The distribution
has a single possible value in both of these cases, so it is now
equivalent to its presence indicator, or that of the value and
bounds.</p>
<p>We get the following database for records where <code>param1</code>
is present:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">show</span><span class="op">(</span><span class="fu"><a href="../reference/autodb.html">autodb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span>
<span>  <span class="va">df_options_with_presence</span>,</span>
<span>  <span class="va">param1_present</span></span>
<span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-10b3b7155e8045a1b2ad" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-10b3b7155e8045a1b2ad">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"constants\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">constants (1 record)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_value\">value<\/TD><TD><\/TD><TD PORT=\"FROM_value\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_value_present\">value_present<\/TD><TD><\/TD><TD PORT=\"FROM_value_present\">logical<\/TD><\/TR>\n    <TR><TD PORT=\"TO_lower_bound_present\">lower_bound_present<\/TD><TD><\/TD><TD PORT=\"FROM_lower_bound_present\">logical<\/TD><\/TR>\n    <TR><TD PORT=\"TO_upper_bound_present\">upper_bound_present<\/TD><TD><\/TD><TD PORT=\"FROM_upper_bound_present\">logical<\/TD><\/TR>\n    <TR><TD PORT=\"TO_interval_distribution_present\">interval_distribution_present<\/TD><TD><\/TD><TD PORT=\"FROM_interval_distribution_present\">logical<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param1_present\">param1_present<\/TD><TD><\/TD><TD PORT=\"FROM_param1_present\">logical<\/TD><\/TR>\n    <\/TABLE>>];\n  \"id\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"4\">id (12 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_id\">id<\/TD><TD BGCOLOR=\"black\"><\/TD><TD><\/TD><TD PORT=\"FROM_id\">integer<\/TD><\/TR>\n    <TR><TD PORT=\"TO_lower_bound\">lower_bound<\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_lower_bound\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_upper_bound\">upper_bound<\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_upper_bound\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_interval_distribution\">interval_distribution<\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_interval_distribution\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param1\">param1<\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_param1\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param2\">param2<\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_param2\">numeric<\/TD><\/TR>\n    <\/TABLE>>];\n  \"interval_distribution\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">interval_distribution (3 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_interval_distribution\">interval_distribution<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_interval_distribution\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param2_present\">param2_present<\/TD><TD><\/TD><TD PORT=\"FROM_param2_present\">logical<\/TD><\/TR>\n    <\/TABLE>>];\n  \"param2\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">param2 (3 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param2\">param2<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_param2\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_param2_present\">param2_present<\/TD><TD><\/TD><TD PORT=\"FROM_param2_present\">logical<\/TD><\/TR>\n    <\/TABLE>>];\n\n  \"id\":FROM_interval_distribution -> \"interval_distribution\":TO_interval_distribution;\n  \"id\":FROM_param2 -> \"param2\":TO_param2;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>In this case, whether <code>param2</code> is present is determined by
the distribution used, as we’d expect.</p>
<p>Since this data splitting is currently a manual process, there are
practical limits to how far we can take this. I have future plans for an
option to account for it in the functional dependency search, but this
would greatly increase the run time is used.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Webster.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
