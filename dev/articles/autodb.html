<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using autodb • autodb</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using autodb">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">autodb</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">3.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/autodb.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/limits.html">Limitations</a></li>
    <li><a class="dropdown-item" href="../articles/nudge.html">A larger example: the nudge dataset</a></li>
    <li><a class="dropdown-item" href="../articles/null.html">Handling missing values</a></li>
    <li><a class="dropdown-item" href="../articles/plans.html">Planned improvements</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CharnelMouse/autodb/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="autodb_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="autodb_files/viz-1.8.2/viz.js"></script><link href="autodb_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="autodb_files/grViz-binding-1.0.11/grViz.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using autodb</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CharnelMouse/autodb/blob/master/vignettes/autodb.Rmd" class="external-link"><code>vignettes/autodb.Rmd</code></a></small>
      <div class="d-none name"><code>autodb.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://charnelmouse.github.io/autodb/">autodb</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'autodb'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     decompose</span></span></code></pre>
<div class="section level2">
<h2 id="terminology">Terminology<a class="anchor" aria-label="anchor" href="#terminology"></a>
</h2>
<p>To avoid confusion, this vignette is consistent with terminology: a
<em>data frame</em> (table) has <em>records</em> (rows) with the same
<em>attributes</em> (columns/variables), and we split it up into a
<em>database</em>, that consists of <em>relations</em> (data frames with
key and foreign key constraints between them). This is in line with
terms used in the relational model.</p>
<p>When we talk about the type of values an attribute can take, we talk
about a data <em>class</em>, as in the relational model and R, rather
than a value type, as in many other programming languages.</p>
</div>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p><code>autodb</code> is described in the DESCRIPTION file in the
following way:</p>
<blockquote>
<p>Automatic normalisation of a data frame to third normal form, with
the intention of easing the process of data cleaning. (Usage to design
your actual database for you is not advised.)</p>
</blockquote>
<p>Let’s cover that with some more detail.</p>
<div class="section level3">
<h3 id="for-data-cleaning">For data cleaning<a class="anchor" aria-label="anchor" href="#for-data-cleaning"></a>
</h3>
<p>Database normalisation works on the principle that our data should
only express a piece of information in a single place. This is done to
reduce the chance that a modification will accidentally change or remove
other pieces of information.</p>
<p>Data cleaning works on the principle that we remove duplicate
observations and structural errors, and have a clear understanding of
any associations between different observations, or parts of
observations. This is done to ensure a high quality for the data used in
analysis, but I have found that it is equally important for making sure
that I understand the domain I am hoping to model.</p>
<p>Normalisation is helpful for both of these areas. I usually use the
original, flat, “tidy” data for the analysis itself. However, for
checking the data’s consistency, and for using the data to learn about
the domain, normalised data is often helpful, whether it’s used for the
analysis or not.</p>
<p>I’ve often started data checking under the following conditions:</p>
<ul>
<li>One-off analyses, where the data is discard at the end, so it’s not
worth the time to get the data into a proper database.</li>
<li>Limited, or unreliable, documentation. This makes it even more
important to do data checking, not just for looking for errors, but also
as an exercise in understanding the problem domain before modelling
it.</li>
<li>Data that fits in local memory, presenting less problems for
automation.</li>
</ul>
<p>It’s in this context that I would usually have to do the
normalisation by hand, and I would like to have a tool that does it
semi-automatically. This package is intended to be that tool, using a
minimal amount of additional libraries.</p>
</div>
<div class="section level3">
<h3 id="not-for-database-design">Not for database design<a class="anchor" aria-label="anchor" href="#not-for-database-design"></a>
</h3>
<p>Good database design is a hard and involved process, which requires a
strong grasp on the domain that the database will hold information on.
Please don’t try to use this package to do it on autopilot. In
particular, the conditions described above mean that the package does
things differently to common practice:</p>
<ul>
<li>Since the package can only work with the data it’s got, the
resulting database schema is specific to the given dataset, rather than
data of that type in general.</li>
<li>As a special case of the above, we need to handle constant
attributes, that have the same value in every record. In a real
database, we would either not store them in the database at all, or
place them with the expectation that they won’t stay constant when more
data is added. The former would hide information from the user, and the
latter approach can’t be decided automatically, so they’re placed in a
“constants” relation with an empty key. Empty keys are allowed in the
relational model, but engines like SQL don’t allow it in practice.</li>
<li>It doesn’t introduce artificial keys, or single-attribute lookup
relations, which are a relational database’s equivalent to factor
levels.</li>
<li>It doesn’t create “virtual relations”, also known as “views”, which
are data-less relations defined in terms of manipulating real relations
(usually to create aggregates). This might change in the future.</li>
</ul>
</div>
<div class="section level3">
<h3 id="to-third-normal-form">To third normal form<a class="anchor" aria-label="anchor" href="#to-third-normal-form"></a>
</h3>
<p><code>autodb</code> gets a given data frame to third normal form:
every attribute depends on the whole key(s), and non-key attributes
depend on nothing but the key(s). This was chosen because there is an
existing algorithm, Bernstein’s synthesis, for normalising to third
normal form, and because it’s the highest normal form that is always
attainable with only real relations and foreign key constraints.</p>
<p>An additional enhancement, called LTK form, is available as an
option: see the section on avoidable attributes for more details.</p>
</div>
</div>
<div class="section level2">
<h2 id="simple-examples">Simple examples<a class="anchor" aria-label="anchor" href="#simple-examples"></a>
</h2>
<p>For most of these simple examples, we use the
<code>ChickWeight</code> dataset, included with base R.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ChickWeight</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      weight           Time           Chick     Diet   </span></span>
<span><span class="co">##  Min.   : 35.0   Min.   : 0.00   13     : 12   1:220  </span></span>
<span><span class="co">##  1st Qu.: 63.0   1st Qu.: 4.00   9      : 12   2:120  </span></span>
<span><span class="co">##  Median :103.0   Median :10.00   20     : 12   3:120  </span></span>
<span><span class="co">##  Mean   :121.8   Mean   :10.72   10     : 12   4:118  </span></span>
<span><span class="co">##  3rd Qu.:163.8   3rd Qu.:16.00   17     : 12          </span></span>
<span><span class="co">##  Max.   :373.0   Max.   :21.00   19     : 12          </span></span>
<span><span class="co">##                                  (Other):506</span></span></code></pre>
<div class="section level3">
<h3 id="normalisation-with-autodb">Normalisation with <code>autodb</code><a class="anchor" aria-label="anchor" href="#normalisation-with-autodb"></a>
</h3>
<p>The simplest way to do normalisation is with the <code>autodb</code>
function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autodb.html">autodb</a></span><span class="op">(</span><span class="va">ChickWeight</span><span class="op">)</span></span>
<span><span class="va">db</span></span></code></pre></div>
<pre><code><span><span class="co">## database with 2 relations</span></span>
<span><span class="co">## 4 attributes: weight, Time, Chick, Diet</span></span>
<span><span class="co">## relation Chick: Chick, Diet; 50 records</span></span>
<span><span class="co">##   key 1: Chick</span></span>
<span><span class="co">## relation Time_Chick: Time, Chick, weight; 578 records</span></span>
<span><span class="co">##   key 1: Time, Chick</span></span>
<span><span class="co">## references:</span></span>
<span><span class="co">## Time_Chick.{Chick} -&gt; Chick.{Chick}</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h3>
<p>There is no plotting method within the <code>autodb</code> package
itself. Instead, there are functions to write normalised objects as
inputs to the Graphviz visualisation software, using the DOT
language.</p>
<p>The generic function to do this is <code>gv</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gv.html">gv</a></span><span class="op">(</span><span class="va">db</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">db_text</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## digraph {</span></span>
<span><span class="co">##   rankdir = "LR"</span></span>
<span><span class="co">##   node [shape=plaintext];</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   "Chick" [label = &lt;</span></span>
<span><span class="co">##     &lt;TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" CELLPADDING="4"&gt;</span></span>
<span><span class="co">##     &lt;TR&gt;&lt;TD COLSPAN="3"&gt;Chick (50 records)&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span><span class="co">##     &lt;TR&gt;&lt;TD PORT="TO_chick"&gt;Chick&lt;/TD&gt;&lt;TD BGCOLOR="black"&gt;&lt;/TD&gt;&lt;TD PORT="FROM_chick"&gt;ordered&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span><span class="co">##     &lt;TR&gt;&lt;TD PORT="TO_diet"&gt;Diet&lt;/TD&gt;&lt;TD&gt;&lt;/TD&gt;&lt;TD PORT="FROM_diet"&gt;factor&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span><span class="co">##     &lt;/TABLE&gt;&gt;];</span></span>
<span><span class="co">##   "Time_Chick" [label = &lt;</span></span>
<span><span class="co">##     &lt;TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" CELLPADDING="4"&gt;</span></span>
<span><span class="co">##     &lt;TR&gt;&lt;TD COLSPAN="3"&gt;Time_Chick (578 records)&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span><span class="co">##     &lt;TR&gt;&lt;TD PORT="TO_time"&gt;Time&lt;/TD&gt;&lt;TD BGCOLOR="black"&gt;&lt;/TD&gt;&lt;TD PORT="FROM_time"&gt;numeric&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span><span class="co">##     &lt;TR&gt;&lt;TD PORT="TO_chick"&gt;Chick&lt;/TD&gt;&lt;TD BGCOLOR="black"&gt;&lt;/TD&gt;&lt;TD PORT="FROM_chick"&gt;ordered&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span><span class="co">##     &lt;TR&gt;&lt;TD PORT="TO_weight"&gt;weight&lt;/TD&gt;&lt;TD&gt;&lt;/TD&gt;&lt;TD PORT="FROM_weight"&gt;numeric&lt;/TD&gt;&lt;/TR&gt;</span></span>
<span><span class="co">##     &lt;/TABLE&gt;&gt;];</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   "Time_Chick":FROM_chick -&gt; "Chick":TO_chick;</span></span>
<span><span class="co">## }</span></span></code></pre>
<p>The resulting code can be saved to a file for passing to Graphviz
elsewhere, or can be passed into an R function that renders Graphviz
code. One option for the latter is <code>grViz</code> from the
<code>DiagrammeR</code> package, but the result is an HTML widget: if
you’re writing a document, this requires inserting 2MB of Javascript
code into the file. If you’re writing a document in Quarto, you can call
GraphViz directly using the <code>dot</code> engine, which avoids
this.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"DiagrammeR"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">show</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">DiagrammeR</span><span class="fu">::</span><span class="fu"><a href="https://rich-iannone.github.io/DiagrammeR/reference/grViz.html" class="external-link">grViz</a></span><span class="op">(</span><span class="fu"><a href="../reference/gv.html">gv</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span></span>
<span>  <span class="va">maybe_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">DiagrammeR</span><span class="fu">::</span><span class="fu"><a href="https://rich-iannone.github.io/DiagrammeR/reference/grViz.html" class="external-link">grViz</a></span><span class="op">(</span><span class="fu"><a href="../reference/gv.html">gv</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>  <span class="va">show</span> <span class="op">&lt;-</span> <span class="va">print</span></span>
<span>  <span class="va">maybe_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">maybe_plot</span><span class="op">(</span><span class="va">db</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"Chick\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">Chick (50 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_chick\">Chick<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_chick\">ordered<\/TD><\/TR>\n    <TR><TD PORT=\"TO_diet\">Diet<\/TD><TD><\/TD><TD PORT=\"FROM_diet\">factor<\/TD><\/TR>\n    <\/TABLE>>];\n  \"Time_Chick\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">Time_Chick (578 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_time\">Time<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_time\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_chick\">Chick<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_chick\">ordered<\/TD><\/TR>\n    <TR><TD PORT=\"TO_weight\">weight<\/TD><TD><\/TD><TD PORT=\"FROM_weight\">numeric<\/TD><\/TR>\n    <\/TABLE>>];\n\n  \"Time_Chick\":FROM_chick -> \"Chick\":TO_chick;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Each relation is represented as a box: the top row gives the relation
name and the number of records, and the other rows list the attributes
and their classes.</p>
<p>In the middle is a grid containing black cells: each column of black
cells represents a <em>key</em> for the relation. Keys are irreducible
subsets of a relation’s attributes, that take a unique set of values in
each record. They can be treated as a unique row identifier. For
example, each chick has a unique <code>Chick</code> value, and each
measurement has a unique <code>Time</code>-<code>Chick</code> pair.</p>
<p>In summary, <code>ChickWeight</code> is split into two relations,
where the time and chick uniquely define a measurement – or a row in the
original data – and the diet is determined by chick alone, i.e. chicks
never have their diet changed.</p>
<p><code>gv</code> also has methods for <code>data.frame</code>, and for
<code>database_schema</code>, which is introduced later.</p>
</div>
<div class="section level3">
<h3 id="finding-functional-dependencies">Finding functional dependencies<a class="anchor" aria-label="anchor" href="#finding-functional-dependencies"></a>
</h3>
<p>Having looked at the final result first, we now look at the
individual steps. The first step is to find the (non-trivial and
minimal) dependencies present in the given data frame. There are various
ways to do this; by default, the package uses FDHitsSep, a depth-first
search algorithm. We run this using the <code>discover</code> function,
setting <code>progress</code> to <code>TRUE</code> to see the steps
taken:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/discover.html">discover</a></span><span class="op">(</span><span class="va">ChickWeight</span>, progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## formatting numerical/complex variables with 7 significant digits</span></span>
<span><span class="co">## simplifying data types</span></span>
<span><span class="co">## calculating single-attribute PLIs</span></span>
<span><span class="co">## sampling difference sets</span></span>
<span><span class="co">## 7 initial diffsets</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## dependant weight</span></span>
<span><span class="co">## dependant Time</span></span>
<span><span class="co">## dependant Chick</span></span>
<span><span class="co">## dependant Diet</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## FDHitsSep complete</span></span>
<span><span class="co">## 9 final diffsets</span></span>
<span><span class="co">## 10 nodes visited</span></span>
<span><span class="co">## 7 partitions cached</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deps</span></span></code></pre></div>
<pre><code><span><span class="co">## 2 functional dependencies</span></span>
<span><span class="co">## 4 attributes: weight, Time, Chick, Diet</span></span>
<span><span class="co">## Time, Chick -&gt; weight</span></span>
<span><span class="co">##       Chick -&gt; Diet</span></span></code></pre>
<p>After simplifying the data to something quicker to iterate over –
specifically, by converting all attributes to have integer values – the
algorithm takes each attribute in turn as a possible dependant, and
finds sets of the other attributes that determine it.</p>
<p>The result is a list of functional dependencies, in the format
<code>determinant set -&gt; dependant</code>, with an attribute named
<code>attrs_order</code> that gives all the attribute names in their
original order. Each of these three parts can be extracted:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/detset.html">detset</a></span><span class="op">(</span><span class="va">deps</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## [1] "Time"  "Chick"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">## [1] "Chick"</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dependant.html">dependant</a></span><span class="op">(</span><span class="va">deps</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "weight" "Diet"</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/attrs_order.html">attrs_order</a></span><span class="op">(</span><span class="va">deps</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "weight" "Time"   "Chick"  "Diet"</span></span></code></pre>
<p>The former two are useful for filtering, as we’ll see later.</p>
</div>
<div class="section level3">
<h3 id="normalisation">Normalisation<a class="anchor" aria-label="anchor" href="#normalisation"></a>
</h3>
<p>Now that we have a list of discovered dependencies, we can construct
a database schema, where the relation schemas are normalised to third
normal form. This is done using a version of Bernstein’s synthesis.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">schema</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/synthesise.html">synthesise</a></span><span class="op">(</span><span class="va">deps</span><span class="op">)</span></span>
<span><span class="va">schema</span></span></code></pre></div>
<pre><code><span><span class="co">## 2 relation schemas</span></span>
<span><span class="co">## 4 attributes: weight, Time, Chick, Diet</span></span>
<span><span class="co">## schema Chick: Chick, Diet</span></span>
<span><span class="co">##   key 1: Chick</span></span>
<span><span class="co">## schema Time_Chick: Time, Chick, weight</span></span>
<span><span class="co">##   key 1: Time, Chick</span></span></code></pre>
<p>Like the database before, we can also plot this database schema:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">maybe_plot</span><span class="op">(</span><span class="va">schema</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"Chick\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">Chick<\/TD><\/TR>\n    <TR><TD PORT=\"TO_chick\">Chick<\/TD><TD PORT=\"FROM_chick\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_diet\">Diet<\/TD><TD PORT=\"FROM_diet\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"Time_Chick\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">Time_Chick<\/TD><\/TR>\n    <TR><TD PORT=\"TO_time\">Time<\/TD><TD PORT=\"FROM_time\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_chick\">Chick<\/TD><TD PORT=\"FROM_chick\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_weight\">weight<\/TD><TD PORT=\"FROM_weight\"><\/TD><\/TR>\n    <\/TABLE>>];\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>This is similar to the database plot given before, but there is some
information not present, that requires the data frame itself. We do have
class information about the attributes, extracted from the data frame
during dependency discovery, but we have no record counts for the
individual relation schemas. However, we do have automatically-generated
names for the individual relations.</p>
<p>Additionally, at this point we have no connections between the
relation schemas, since Bernstein’s synthesis doesn’t supply information
about foreign key references. We could use this database schema to build
a database, but we’d rather add the foreign key references first.</p>
</div>
<div class="section level3">
<h3 id="tuning-detection-and-normalisation">Tuning detection and normalisation<a class="anchor" aria-label="anchor" href="#tuning-detection-and-normalisation"></a>
</h3>
<p>Let’s look at a different dataset for a moment, to look at some cases
where we don’t want to use the dependencies as given. We’ll use the
Titanic data set, also provided with base R. This data is in array form,
so we first convert it to data frame form:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Titanic</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Class</th>
<th align="left">Sex</th>
<th align="left">Age</th>
<th align="left">Survived</th>
<th align="right">Freq</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">35</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">No</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">118</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">154</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">387</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">670</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">89</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">No</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Male</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Female</td>
<td align="left">Child</td>
<td align="left">Yes</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">57</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">75</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Male</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">192</td>
</tr>
<tr class="odd">
<td align="left">1st</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">140</td>
</tr>
<tr class="even">
<td align="left">2nd</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">80</td>
</tr>
<tr class="odd">
<td align="left">3rd</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">76</td>
</tr>
<tr class="even">
<td align="left">Crew</td>
<td align="left">Female</td>
<td align="left">Adult</td>
<td align="left">Yes</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<p>This is a simple set of data, with a single count observation,
<code>Freq</code>, for each combination of the four determining
attributes. In other words, the relation is already normalised, so we
only expect one relation in the normalised database.</p>
<p>If we use <code>autodb</code> again, we get the following
database:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">show</span><span class="op">(</span><span class="fu"><a href="../reference/autodb.html">autodb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Titanic</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-36aa3d2a04d42bbc2145" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"Class_Survived_Freq\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">Class_Survived_Freq (28 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_class\">Class<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_class\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_survived\">Survived<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_survived\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_freq\">Freq<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_freq\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_age\">Age<\/TD><TD><\/TD><TD PORT=\"FROM_age\">factor<\/TD><\/TR>\n    <\/TABLE>>];\n  \"Sex_Survived_Freq\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">Sex_Survived_Freq (28 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_sex\">Sex<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_sex\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_survived\">Survived<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_survived\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_freq\">Freq<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_freq\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_age\">Age<\/TD><TD><\/TD><TD PORT=\"FROM_age\">factor<\/TD><\/TR>\n    <\/TABLE>>];\n  \"Class_Sex_Age_Survived\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">Class_Sex_Age_Survived (32 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_class\">Class<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_class\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_sex\">Sex<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_sex\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_age\">Age<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_age\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_survived\">Survived<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_survived\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_freq\">Freq<\/TD><TD><\/TD><TD PORT=\"FROM_freq\">numeric<\/TD><\/TR>\n    <\/TABLE>>];\n\n  \"Class_Sex_Age_Survived\":FROM_class -> \"Class_Survived_Freq\":TO_class;\n  \"Class_Sex_Age_Survived\":FROM_survived -> \"Class_Survived_Freq\":TO_survived;\n  \"Class_Sex_Age_Survived\":FROM_freq -> \"Class_Survived_Freq\":TO_freq;\n  \"Class_Sex_Age_Survived\":FROM_sex -> \"Sex_Survived_Freq\":TO_sex;\n  \"Class_Sex_Age_Survived\":FROM_survived -> \"Sex_Survived_Freq\":TO_survived;\n  \"Class_Sex_Age_Survived\":FROM_freq -> \"Sex_Survived_Freq\":TO_freq;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Oops! The search found some functional dependencies where the count
could be used to determine another attribute. These are clearly
spurious: frequency count can’t causally determine age, for example.
However, the algorithm still finds these dependencies, because the
counts are unique often enough to make these dependencies hold in the
given data.</p>
<p>There are two approaches we can take to eliminate these spurious
dependencies: not letting them be detected in the first place, and
removing them before using <code>synthesise</code>.</p>
<p>To stop them being detected, we can put constraints on what is
discovered by <code>discover</code>: we can ask for certain attributes
to not be considered as determinants, or we can exclude attributes that
inherit from certain classes. In this example, we could exclude
<code>Freq</code> from being considered:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">titanic_deps_freqonly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/discover.html">discover</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Titanic</span><span class="op">)</span>, exclude <span class="op">=</span> <span class="st">"Freq"</span><span class="op">)</span></span>
<span><span class="va">titanic_deps_freqonly</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 functional dependency</span></span>
<span><span class="co">## 5 attributes: Class, Sex, Age, Survived, Freq</span></span>
<span><span class="co">## Class, Sex, Age, Survived -&gt; Freq</span></span></code></pre>
<p>Alternatively, we could exclude all attributes that inherit from
“numeric”:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">titanic_deps_freqonly</span>, <span class="fu"><a href="../reference/discover.html">discover</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Titanic</span><span class="op">)</span>, exclude_class <span class="op">=</span> <span class="st">"numeric"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>These can both be used as arguments to <code>autodb</code> too:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">show</span><span class="op">(</span><span class="fu"><a href="../reference/autodb.html">autodb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Titanic</span><span class="op">)</span>, exclude <span class="op">=</span> <span class="st">"Freq"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-febe03efa1a2d8d52a86" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"Class_Sex_Age_Survived\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">Class_Sex_Age_Survived (32 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_class\">Class<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_class\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_sex\">Sex<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_sex\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_age\">Age<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_age\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_survived\">Survived<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_survived\">factor<\/TD><\/TR>\n    <TR><TD PORT=\"TO_freq\">Freq<\/TD><TD><\/TD><TD PORT=\"FROM_freq\">numeric<\/TD><\/TR>\n    <\/TABLE>>];\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Generally, excluding numeric attributes as determinants is often
useful, because we expect non-integer numbers to be a measurement, not
part of a primary key.</p>
<p>Alternatively, we could remove unwanted dependencies before using
<code>decompose</code>. Here are the found dependencies, if we don’t
exclude anything:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">titanic_deps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/discover.html">discover</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Titanic</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">titanic_deps</span></span></code></pre></div>
<pre><code><span><span class="co">## 3 functional dependencies</span></span>
<span><span class="co">## 5 attributes: Class, Sex, Age, Survived, Freq</span></span>
<span><span class="co">##       Sex, Survived, Freq -&gt; Age</span></span>
<span><span class="co">##     Class, Survived, Freq -&gt; Age</span></span>
<span><span class="co">## Class, Sex, Age, Survived -&gt; Freq</span></span></code></pre>
<p>We can remove the unwanted dependencies, where <code>Age</code> is
the dependant:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">titanic_deps</span><span class="op">[</span><span class="fu"><a href="../reference/dependant.html">dependant</a></span><span class="op">(</span><span class="va">titanic_deps</span><span class="op">)</span> <span class="op">==</span> <span class="st">"Freq"</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 functional dependency</span></span>
<span><span class="co">## 5 attributes: Class, Sex, Age, Survived, Freq</span></span>
<span><span class="co">## Class, Sex, Age, Survived -&gt; Freq</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="adding-foreign-key-references">Adding foreign key references<a class="anchor" aria-label="anchor" href="#adding-foreign-key-references"></a>
</h3>
<p>Getting back to our <code>ChickWeight</code> example, we now have a
database schema, consisting of a list of <code>relation</code> schemas.
However, we have no information about how these relation schemas are
linked to each other. In particular, we have no information about
foreign keys. We can add this information using
<code>autoref</code>:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linked_schema</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autoref.html">autoref</a></span><span class="op">(</span><span class="va">schema</span><span class="op">)</span></span>
<span><span class="va">linked_schema</span></span></code></pre></div>
<pre><code><span><span class="co">## database schema with 2 relation schemas</span></span>
<span><span class="co">## 4 attributes: weight, Time, Chick, Diet</span></span>
<span><span class="co">## schema Chick: Chick, Diet</span></span>
<span><span class="co">##   key 1: Chick</span></span>
<span><span class="co">## schema Time_Chick: Time, Chick, weight</span></span>
<span><span class="co">##   key 1: Time, Chick</span></span>
<span><span class="co">## references:</span></span>
<span><span class="co">## Time_Chick.{Chick} -&gt; Chick.{Chick}</span></span></code></pre>
<p>We could also have used <code>normalise</code>, instead of
<code>synthesise</code> and <code>autoref</code> separately:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/normalise.html">normalise</a></span><span class="op">(</span><span class="va">deps</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## database schema with 2 relation schemas</span></span>
<span><span class="co">## 4 attributes: weight, Time, Chick, Diet</span></span>
<span><span class="co">## schema Chick: Chick, Diet</span></span>
<span><span class="co">##   key 1: Chick</span></span>
<span><span class="co">## schema Time_Chick: Time, Chick, weight</span></span>
<span><span class="co">##   key 1: Time, Chick</span></span>
<span><span class="co">## references:</span></span>
<span><span class="co">## Time_Chick.{Chick} -&gt; Chick.{Chick}</span></span></code></pre>
<p>Plotting this updated database schema shows the same relation schemas
as before, linked together by foreign key references:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">show</span><span class="op">(</span><span class="va">linked_schema</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-1fb4450895fe099f74a1" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"Chick\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">Chick<\/TD><\/TR>\n    <TR><TD PORT=\"TO_chick\">Chick<\/TD><TD PORT=\"FROM_chick\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_diet\">Diet<\/TD><TD PORT=\"FROM_diet\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"Time_Chick\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">Time_Chick<\/TD><\/TR>\n    <TR><TD PORT=\"TO_time\">Time<\/TD><TD PORT=\"FROM_time\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_chick\">Chick<\/TD><TD PORT=\"FROM_chick\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_weight\">weight<\/TD><TD PORT=\"FROM_weight\"><\/TD><\/TR>\n    <\/TABLE>>];\n\n  \"Time_Chick\":FROM_chick -> \"Chick\":TO_chick;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="decomposing-the-original-relation">Decomposing the original relation<a class="anchor" aria-label="anchor" href="#decomposing-the-original-relation"></a>
</h3>
<p>Finally, once we have our normalised database schema, we can apply it
to our original data frame, or a new one with the same structure. This
results in a normalised database, as we got from using
<code>autodb</code>:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decompose.html">decompose</a></span><span class="op">(</span><span class="va">ChickWeight</span>, <span class="va">linked_schema</span><span class="op">)</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">db2</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-10b3b7155e8045a1b2ad" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-10b3b7155e8045a1b2ad">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"Chick\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">Chick (50 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_chick\">Chick<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_chick\">ordered<\/TD><\/TR>\n    <TR><TD PORT=\"TO_diet\">Diet<\/TD><TD><\/TD><TD PORT=\"FROM_diet\">factor<\/TD><\/TR>\n    <\/TABLE>>];\n  \"Time_Chick\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">Time_Chick (578 records)<\/TD><\/TR>\n    <TR><TD PORT=\"TO_time\">Time<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_time\">numeric<\/TD><\/TR>\n    <TR><TD PORT=\"TO_chick\">Chick<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_chick\">ordered<\/TD><\/TR>\n    <TR><TD PORT=\"TO_weight\">weight<\/TD><TD><\/TD><TD PORT=\"FROM_weight\">numeric<\/TD><\/TR>\n    <\/TABLE>>];\n\n  \"Time_Chick\":FROM_chick -> \"Chick\":TO_chick;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>We now have the record counts added.</p>
</div>
<div class="section level3">
<h3 id="rejoining-a-database-back-into-a-data-frame">Rejoining a database back into a data frame<a class="anchor" aria-label="anchor" href="#rejoining-a-database-back-into-a-data-frame"></a>
</h3>
<p>We can reverse the process of turning a data frame into a database
with the <code>rejoin</code> function. This may not be identical to
<code>ChickWeight</code>, since the rows may have been rearranged.
However, we can use the convenience function <code>df_equiv</code> to
check for equivalence under row reordering:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rejoined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rejoin.html">rejoin</a></span><span class="op">(</span><span class="va">db</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rejoined</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      weight           Time           Chick     Diet   </span></span>
<span><span class="co">##  Min.   : 35.0   Min.   : 0.00   13     : 12   1:220  </span></span>
<span><span class="co">##  1st Qu.: 63.0   1st Qu.: 4.00   9      : 12   2:120  </span></span>
<span><span class="co">##  Median :103.0   Median :10.00   20     : 12   3:120  </span></span>
<span><span class="co">##  Mean   :121.8   Mean   :10.72   10     : 12   4:118  </span></span>
<span><span class="co">##  3rd Qu.:163.8   3rd Qu.:16.00   17     : 12          </span></span>
<span><span class="co">##  Max.   :373.0   Max.   :21.00   19     : 12          </span></span>
<span><span class="co">##                                  (Other):506</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">rejoined</span>, <span class="va">ChickWeight</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/df_equiv.html">df_equiv</a></span><span class="op">(</span><span class="va">rejoined</span>, <span class="va">ChickWeight</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>When rejoined, the relation attributes will be in the original order.
However, the record order might have changed.</p>
</div>
</div>
<div class="section level2">
<h2 id="other-features">Other features<a class="anchor" aria-label="anchor" href="#other-features"></a>
</h2>
<div class="section level3">
<h3 id="approximate-dependencies-and-database-reduction">Approximate dependencies and database reduction<a class="anchor" aria-label="anchor" href="#approximate-dependencies-and-database-reduction"></a>
</h3>
<p>Larger datasets can often have entry errors, without an easy way to
remove or deal with them. For this reason, we might be interested in
“approximate” functional dependencies, which hold after removing a
bounded amount of violating records.</p>
<p>Suppose that we normalise <code>nudge</code> again, without any
manual dependency removal, but allowing approximate dependencies. We
could cheat, knowing that the questionable data example found above
showed there to be two questionable records: one for a duplicated
publication ID, and one for a duplicated reference. Since
<code>nudge</code> has 447 records, we can get rid of the resulting
questionable dependencies by setting the accuracy to allow two
discrepant records.</p>
<p>The <code>accuracy</code> argument for <code>discover</code> expects
a number between zero and one, determining what proportion of a data
frame’s records need to satisfy a given dependency for the algorithm to
consider it valid. By default, it’s equal to one, so only exact
dependencies are returned. If we set it to less than one, we need to use
the slower DFD search algorithm, since approximate dependency search is
not implemented for the default FDHitsSep algorithm.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">show</span><span class="op">(</span><span class="fu"><a href="../reference/normalise.html">normalise</a></span><span class="op">(</span><span class="fu"><a href="../reference/discover.html">discover</a></span><span class="op">(</span></span>
<span>  <span class="va">nudge</span>,</span>
<span>  accuracy <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fl">2</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">nudge</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"DFD"</span>,</span>
<span>  exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n_study"</span>, <span class="st">"n_comparison"</span>, <span class="st">"n_control"</span>, <span class="st">"n_intervention"</span><span class="op">)</span>,</span>
<span>  exclude_class <span class="op">=</span> <span class="st">"numeric"</span></span>
<span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-4018eef1a407a0df6b52" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-4018eef1a407a0df6b52">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"publication_id\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"4\">publication_id<\/TD><\/TR>\n    <TR><TD PORT=\"TO_publication_id\">publication_id<\/TD><TD BGCOLOR=\"black\"><\/TD><TD><\/TD><TD PORT=\"FROM_publication_id\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_reference\">reference<\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_reference\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_title\">title<\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_title\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_year\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_population\">population<\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_population\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_wansink\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"study_id\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">study_id<\/TD><\/TR>\n    <TR><TD PORT=\"TO_study_id\">study_id<\/TD><TD PORT=\"FROM_study_id\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_publication_id\">publication_id<\/TD><TD PORT=\"FROM_publication_id\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_n_study\">n_study<\/TD><TD PORT=\"FROM_n_study\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_binary_outcome\">binary_outcome<\/TD><TD PORT=\"FROM_binary_outcome\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"es_id\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">es_id<\/TD><\/TR>\n    <TR><TD PORT=\"TO_es_id\">es_id<\/TD><TD PORT=\"FROM_es_id\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_study_id\">study_id<\/TD><TD PORT=\"FROM_study_id\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_n_comparison\">n_comparison<\/TD><TD PORT=\"FROM_n_comparison\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_n_control\">n_control<\/TD><TD PORT=\"FROM_n_control\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_n_intervention\">n_intervention<\/TD><TD PORT=\"FROM_n_intervention\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_mean_control\">mean_control<\/TD><TD PORT=\"FROM_mean_control\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_sd_control\">sd_control<\/TD><TD PORT=\"FROM_sd_control\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_mean_intervention\">mean_intervention<\/TD><TD PORT=\"FROM_mean_intervention\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_sd_intervention\">sd_intervention<\/TD><TD PORT=\"FROM_sd_intervention\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_cohens_d\">cohens_d<\/TD><TD PORT=\"FROM_cohens_d\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_variance_d\">variance_d<\/TD><TD PORT=\"FROM_variance_d\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"intervention_technique\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">intervention_technique<\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_category\">intervention_category<\/TD><TD PORT=\"FROM_intervention_category\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"publication_id_type_experiment\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">publication_id_type_experiment<\/TD><\/TR>\n    <TR><TD PORT=\"TO_publication_id\">publication_id<\/TD><TD PORT=\"FROM_publication_id\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_location\">location<\/TD><TD PORT=\"FROM_location\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"publication_id_intervention_category_type_experiment\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">publication_id_intervention_category_type_experiment<\/TD><\/TR>\n    <TR><TD PORT=\"TO_publication_id\">publication_id<\/TD><TD PORT=\"FROM_publication_id\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_category\">intervention_category<\/TD><TD PORT=\"FROM_intervention_category\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\"><\/TD><\/TR>\n    <\/TABLE>>];\n\n  \"publication_id_type_experiment\":FROM_publication_id -> \"publication_id\":TO_publication_id;\n  \"es_id\":FROM_study_id -> \"study_id\":TO_study_id;\n  \"es_id\":FROM_intervention_technique -> \"intervention_technique\":TO_intervention_technique;\n  \"study_id\":FROM_publication_id -> \"publication_id_type_experiment\":TO_publication_id;\n  \"study_id\":FROM_type_experiment -> \"publication_id_type_experiment\":TO_type_experiment;\n  \"publication_id_intervention_category_type_experiment\":FROM_publication_id -> \"publication_id_type_experiment\":TO_publication_id;\n  \"publication_id_intervention_category_type_experiment\":FROM_type_experiment -> \"publication_id_type_experiment\":TO_type_experiment;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Currently <code>decompose</code> doesn’t account for approximate
dependencies, resulting in invalid databases, so here we just work with
the database schema.</p>
<p>Compare this to the database schema we arrived at manually:</p>
<ul>
<li>The publication ID, the title, and the reference are considered
equivalent, as we’d have originally expected.</li>
<li>There is an additional relation, showing <code>approximation</code>
to be approximately determined by some publication- and study-level
attributes, rather than functionally determined at the effect-size
level.</li>
</ul>
<p>Lowering the accuracy results in more dependencies being found, and
so in more relations. The number of relations can get very large. For
example, suppose we instead set the accuracy to <code>0.99</code>,
returning any approximate dependencies that hold in at least 443
records.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nudge_approx_database_schema</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/discover.html">discover</a></span><span class="op">(</span></span>
<span>  <span class="va">nudge</span>,</span>
<span>  accuracy <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"DFD"</span>,</span>
<span>  exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n_study"</span>, <span class="st">"n_comparison"</span>, <span class="st">"n_control"</span>, <span class="st">"n_intervention"</span><span class="op">)</span>,</span>
<span>  exclude_class <span class="op">=</span> <span class="st">"numeric"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/normalise.html">normalise</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">nudge_approx_database_schema</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-5b1b2f4ad92281566982" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-5b1b2f4ad92281566982">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"publication_id\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"4\">publication_id<\/TD><\/TR>\n    <TR><TD PORT=\"TO_publication_id\">publication_id<\/TD><TD BGCOLOR=\"black\"><\/TD><TD><\/TD><TD PORT=\"FROM_publication_id\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_reference\">reference<\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_reference\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_title\">title<\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_title\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_year\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_population\">population<\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_population\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_wansink\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"study_id\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">study_id<\/TD><\/TR>\n    <TR><TD PORT=\"TO_study_id\">study_id<\/TD><TD PORT=\"FROM_study_id\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_publication_id\">publication_id<\/TD><TD PORT=\"FROM_publication_id\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_n_study\">n_study<\/TD><TD PORT=\"FROM_n_study\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"es_id\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">es_id<\/TD><\/TR>\n    <TR><TD PORT=\"TO_es_id\">es_id<\/TD><TD PORT=\"FROM_es_id\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_study_id\">study_id<\/TD><TD PORT=\"FROM_study_id\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_n_comparison\">n_comparison<\/TD><TD PORT=\"FROM_n_comparison\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_n_control\">n_control<\/TD><TD PORT=\"FROM_n_control\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_n_intervention\">n_intervention<\/TD><TD PORT=\"FROM_n_intervention\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_mean_control\">mean_control<\/TD><TD PORT=\"FROM_mean_control\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_sd_control\">sd_control<\/TD><TD PORT=\"FROM_sd_control\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_mean_intervention\">mean_intervention<\/TD><TD PORT=\"FROM_mean_intervention\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_sd_intervention\">sd_intervention<\/TD><TD PORT=\"FROM_sd_intervention\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_cohens_d\">cohens_d<\/TD><TD PORT=\"FROM_cohens_d\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_variance_d\">variance_d<\/TD><TD PORT=\"FROM_variance_d\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"intervention_technique\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">intervention_technique<\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_category\">intervention_category<\/TD><TD PORT=\"FROM_intervention_category\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"publication_id_domain\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">publication_id_domain<\/TD><\/TR>\n    <TR><TD PORT=\"TO_publication_id\">publication_id<\/TD><TD PORT=\"FROM_publication_id\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_binary_outcome\">binary_outcome<\/TD><TD PORT=\"FROM_binary_outcome\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"publication_id_type_experiment\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">publication_id_type_experiment<\/TD><\/TR>\n    <TR><TD PORT=\"TO_publication_id\">publication_id<\/TD><TD PORT=\"FROM_publication_id\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_location\">location<\/TD><TD PORT=\"FROM_location\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_binary_outcome\">binary_outcome<\/TD><TD PORT=\"FROM_binary_outcome\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_domain_intervention_technique\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_domain_intervention_technique<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD PORT=\"FROM_wansink\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_location_domain_type_experiment\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_location_domain_type_experiment<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_location\">location<\/TD><TD PORT=\"FROM_location\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD PORT=\"FROM_wansink\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_location_domain_approximation\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_location_domain_approximation<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_location\">location<\/TD><TD PORT=\"FROM_location\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD PORT=\"FROM_wansink\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_domain_intervention_category_type_experiment\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_domain_intervention_category_type_experiment<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_category\">intervention_category<\/TD><TD PORT=\"FROM_intervention_category\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD PORT=\"FROM_wansink\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_domain_intervention_technique_binary_outcome\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_domain_intervention_technique_binary_outcome<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_binary_outcome\">binary_outcome<\/TD><TD PORT=\"FROM_binary_outcome\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_population\">population<\/TD><TD PORT=\"FROM_population\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_domain_type_experiment_approximation\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_domain_type_experiment_approximation<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD PORT=\"FROM_wansink\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_intervention_technique_type_experiment_approximation\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_intervention_technique_type_experiment_approximation<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD PORT=\"FROM_wansink\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_intervention_technique_binary_outcome_approximation\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_intervention_technique_binary_outcome_approximation<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_binary_outcome\">binary_outcome<\/TD><TD PORT=\"FROM_binary_outcome\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD PORT=\"FROM_wansink\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_location_domain_intervention_category_type_experiment\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_location_domain_intervention_category_type_experiment<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_location\">location<\/TD><TD PORT=\"FROM_location\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_category\">intervention_category<\/TD><TD PORT=\"FROM_intervention_category\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_population\">population<\/TD><TD PORT=\"FROM_population\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_location_domain_intervention_technique_approximation\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_location_domain_intervention_technique_approximation<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_location\">location<\/TD><TD PORT=\"FROM_location\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_population\">population<\/TD><TD PORT=\"FROM_population\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_location_intervention_technique_population_approximation\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_location_intervention_technique_population_approximation<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_location\">location<\/TD><TD PORT=\"FROM_location\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_population\">population<\/TD><TD PORT=\"FROM_population\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD PORT=\"FROM_wansink\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_domain_intervention_category_population_approximation\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_domain_intervention_category_population_approximation<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_category\">intervention_category<\/TD><TD PORT=\"FROM_intervention_category\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_population\">population<\/TD><TD PORT=\"FROM_population\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD PORT=\"FROM_wansink\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_domain_intervention_category_binary_outcome_approximation\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_domain_intervention_category_binary_outcome_approximation<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_category\">intervention_category<\/TD><TD PORT=\"FROM_intervention_category\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_binary_outcome\">binary_outcome<\/TD><TD PORT=\"FROM_binary_outcome\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD PORT=\"FROM_wansink\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_domain_intervention_technique_type_experiment_approximation\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_domain_intervention_technique_type_experiment_approximation<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_population\">population<\/TD><TD PORT=\"FROM_population\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_location_domain_intervention_category_binary_outcome_wansink\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_location_domain_intervention_category_binary_outcome_wansink<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_location\">location<\/TD><TD PORT=\"FROM_location\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_category\">intervention_category<\/TD><TD PORT=\"FROM_intervention_category\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_binary_outcome\">binary_outcome<\/TD><TD PORT=\"FROM_binary_outcome\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD PORT=\"FROM_wansink\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_population\">population<\/TD><TD PORT=\"FROM_population\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation<\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD PORT=\"FROM_year\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_location\">location<\/TD><TD PORT=\"FROM_location\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_binary_outcome\">binary_outcome<\/TD><TD PORT=\"FROM_binary_outcome\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_publication_id\">publication_id<\/TD><TD PORT=\"FROM_publication_id\"><\/TD><\/TR>\n    <\/TABLE>>];\n\n  \"publication_id_domain\":FROM_publication_id -> \"publication_id\":TO_publication_id;\n  \"publication_id_type_experiment\":FROM_publication_id -> \"publication_id\":TO_publication_id;\n  \"es_id\":FROM_study_id -> \"study_id\":TO_study_id;\n  \"es_id\":FROM_intervention_technique -> \"intervention_technique\":TO_intervention_technique;\n  \"year_domain_intervention_technique\":FROM_intervention_technique -> \"intervention_technique\":TO_intervention_technique;\n  \"year_intervention_technique_type_experiment_approximation\":FROM_intervention_technique -> \"intervention_technique\":TO_intervention_technique;\n  \"year_intervention_technique_binary_outcome_approximation\":FROM_intervention_technique -> \"intervention_technique\":TO_intervention_technique;\n  \"year_location_intervention_technique_population_approximation\":FROM_intervention_technique -> \"intervention_technique\":TO_intervention_technique;\n  \"study_id\":FROM_publication_id -> \"publication_id_domain\":TO_publication_id;\n  \"study_id\":FROM_domain -> \"publication_id_domain\":TO_domain;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_publication_id -> \"publication_id_domain\":TO_publication_id;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_domain -> \"publication_id_domain\":TO_domain;\n  \"study_id\":FROM_publication_id -> \"publication_id_type_experiment\":TO_publication_id;\n  \"study_id\":FROM_type_experiment -> \"publication_id_type_experiment\":TO_type_experiment;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_publication_id -> \"publication_id_type_experiment\":TO_publication_id;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_type_experiment -> \"publication_id_type_experiment\":TO_type_experiment;\n  \"year_domain_intervention_technique_binary_outcome\":FROM_year -> \"year_domain_intervention_technique\":TO_year;\n  \"year_domain_intervention_technique_binary_outcome\":FROM_domain -> \"year_domain_intervention_technique\":TO_domain;\n  \"year_domain_intervention_technique_binary_outcome\":FROM_intervention_technique -> \"year_domain_intervention_technique\":TO_intervention_technique;\n  \"year_location_domain_intervention_technique_approximation\":FROM_year -> \"year_domain_intervention_technique\":TO_year;\n  \"year_location_domain_intervention_technique_approximation\":FROM_domain -> \"year_domain_intervention_technique\":TO_domain;\n  \"year_location_domain_intervention_technique_approximation\":FROM_intervention_technique -> \"year_domain_intervention_technique\":TO_intervention_technique;\n  \"year_domain_intervention_technique_type_experiment_approximation\":FROM_year -> \"year_domain_intervention_technique\":TO_year;\n  \"year_domain_intervention_technique_type_experiment_approximation\":FROM_domain -> \"year_domain_intervention_technique\":TO_domain;\n  \"year_domain_intervention_technique_type_experiment_approximation\":FROM_intervention_technique -> \"year_domain_intervention_technique\":TO_intervention_technique;\n  \"year_location_domain_intervention_category_type_experiment\":FROM_year -> \"year_location_domain_type_experiment\":TO_year;\n  \"year_location_domain_intervention_category_type_experiment\":FROM_location -> \"year_location_domain_type_experiment\":TO_location;\n  \"year_location_domain_intervention_category_type_experiment\":FROM_domain -> \"year_location_domain_type_experiment\":TO_domain;\n  \"year_location_domain_intervention_category_type_experiment\":FROM_type_experiment -> \"year_location_domain_type_experiment\":TO_type_experiment;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_year -> \"year_location_domain_type_experiment\":TO_year;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_location -> \"year_location_domain_type_experiment\":TO_location;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_domain -> \"year_location_domain_type_experiment\":TO_domain;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_type_experiment -> \"year_location_domain_type_experiment\":TO_type_experiment;\n  \"year_location_domain_intervention_technique_approximation\":FROM_year -> \"year_location_domain_approximation\":TO_year;\n  \"year_location_domain_intervention_technique_approximation\":FROM_location -> \"year_location_domain_approximation\":TO_location;\n  \"year_location_domain_intervention_technique_approximation\":FROM_domain -> \"year_location_domain_approximation\":TO_domain;\n  \"year_location_domain_intervention_technique_approximation\":FROM_approximation -> \"year_location_domain_approximation\":TO_approximation;\n  \"year_location_domain_intervention_category_type_experiment\":FROM_year -> \"year_domain_intervention_category_type_experiment\":TO_year;\n  \"year_location_domain_intervention_category_type_experiment\":FROM_domain -> \"year_domain_intervention_category_type_experiment\":TO_domain;\n  \"year_location_domain_intervention_category_type_experiment\":FROM_intervention_category -> \"year_domain_intervention_category_type_experiment\":TO_intervention_category;\n  \"year_location_domain_intervention_category_type_experiment\":FROM_type_experiment -> \"year_domain_intervention_category_type_experiment\":TO_type_experiment;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_year -> \"year_domain_intervention_technique_binary_outcome\":TO_year;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_domain -> \"year_domain_intervention_technique_binary_outcome\":TO_domain;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_intervention_technique -> \"year_domain_intervention_technique_binary_outcome\":TO_intervention_technique;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_binary_outcome -> \"year_domain_intervention_technique_binary_outcome\":TO_binary_outcome;\n  \"year_domain_intervention_technique_type_experiment_approximation\":FROM_year -> \"year_domain_type_experiment_approximation\":TO_year;\n  \"year_domain_intervention_technique_type_experiment_approximation\":FROM_domain -> \"year_domain_type_experiment_approximation\":TO_domain;\n  \"year_domain_intervention_technique_type_experiment_approximation\":FROM_type_experiment -> \"year_domain_type_experiment_approximation\":TO_type_experiment;\n  \"year_domain_intervention_technique_type_experiment_approximation\":FROM_approximation -> \"year_domain_type_experiment_approximation\":TO_approximation;\n  \"year_domain_intervention_technique_type_experiment_approximation\":FROM_year -> \"year_intervention_technique_type_experiment_approximation\":TO_year;\n  \"year_domain_intervention_technique_type_experiment_approximation\":FROM_intervention_technique -> \"year_intervention_technique_type_experiment_approximation\":TO_intervention_technique;\n  \"year_domain_intervention_technique_type_experiment_approximation\":FROM_type_experiment -> \"year_intervention_technique_type_experiment_approximation\":TO_type_experiment;\n  \"year_domain_intervention_technique_type_experiment_approximation\":FROM_approximation -> \"year_intervention_technique_type_experiment_approximation\":TO_approximation;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_year -> \"year_intervention_technique_binary_outcome_approximation\":TO_year;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_intervention_technique -> \"year_intervention_technique_binary_outcome_approximation\":TO_intervention_technique;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_binary_outcome -> \"year_intervention_technique_binary_outcome_approximation\":TO_binary_outcome;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_approximation -> \"year_intervention_technique_binary_outcome_approximation\":TO_approximation;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_year -> \"year_location_domain_intervention_technique_approximation\":TO_year;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_location -> \"year_location_domain_intervention_technique_approximation\":TO_location;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_domain -> \"year_location_domain_intervention_technique_approximation\":TO_domain;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_intervention_technique -> \"year_location_domain_intervention_technique_approximation\":TO_intervention_technique;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_approximation -> \"year_location_domain_intervention_technique_approximation\":TO_approximation;\n  \"year_location_domain_intervention_technique_approximation\":FROM_year -> \"year_location_intervention_technique_population_approximation\":TO_year;\n  \"year_location_domain_intervention_technique_approximation\":FROM_location -> \"year_location_intervention_technique_population_approximation\":TO_location;\n  \"year_location_domain_intervention_technique_approximation\":FROM_intervention_technique -> \"year_location_intervention_technique_population_approximation\":TO_intervention_technique;\n  \"year_location_domain_intervention_technique_approximation\":FROM_population -> \"year_location_intervention_technique_population_approximation\":TO_population;\n  \"year_location_domain_intervention_technique_approximation\":FROM_approximation -> \"year_location_intervention_technique_population_approximation\":TO_approximation;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_year -> \"year_domain_intervention_technique_type_experiment_approximation\":TO_year;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_domain -> \"year_domain_intervention_technique_type_experiment_approximation\":TO_domain;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_intervention_technique -> \"year_domain_intervention_technique_type_experiment_approximation\":TO_intervention_technique;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_type_experiment -> \"year_domain_intervention_technique_type_experiment_approximation\":TO_type_experiment;\n  \"year_location_domain_intervention_technique_type_experiment_binary_outcome_approximation\":FROM_approximation -> \"year_domain_intervention_technique_type_experiment_approximation\":TO_approximation;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>This is a little overwhelming, so we’ll use a utility function called
<code>reduce</code>. This returns only the named “main” relation, and
any relations for which it is a descendant via foreign key references.
Reducing the approximate schema, with the effect size table as the main
table, gives us this set of relations:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">show</span><span class="op">(</span><span class="fu"><a href="../reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">nudge_approx_database_schema</span>, <span class="st">"es_id"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-25c3e940e6859592f801" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-25c3e940e6859592f801">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"es_id\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">es_id<\/TD><\/TR>\n    <TR><TD PORT=\"TO_es_id\">es_id<\/TD><TD PORT=\"FROM_es_id\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_study_id\">study_id<\/TD><TD PORT=\"FROM_study_id\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_n_comparison\">n_comparison<\/TD><TD PORT=\"FROM_n_comparison\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_n_control\">n_control<\/TD><TD PORT=\"FROM_n_control\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_n_intervention\">n_intervention<\/TD><TD PORT=\"FROM_n_intervention\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_mean_control\">mean_control<\/TD><TD PORT=\"FROM_mean_control\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_sd_control\">sd_control<\/TD><TD PORT=\"FROM_sd_control\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_mean_intervention\">mean_intervention<\/TD><TD PORT=\"FROM_mean_intervention\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_sd_intervention\">sd_intervention<\/TD><TD PORT=\"FROM_sd_intervention\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_cohens_d\">cohens_d<\/TD><TD PORT=\"FROM_cohens_d\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_variance_d\">variance_d<\/TD><TD PORT=\"FROM_variance_d\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"intervention_technique\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">intervention_technique<\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_technique\">intervention_technique<\/TD><TD PORT=\"FROM_intervention_technique\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_intervention_category\">intervention_category<\/TD><TD PORT=\"FROM_intervention_category\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"publication_id\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"4\">publication_id<\/TD><\/TR>\n    <TR><TD PORT=\"TO_publication_id\">publication_id<\/TD><TD BGCOLOR=\"black\"><\/TD><TD><\/TD><TD PORT=\"FROM_publication_id\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_reference\">reference<\/TD><TD><\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_reference\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_title\">title<\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_title\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_year\">year<\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_year\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_population\">population<\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_population\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_wansink\">wansink<\/TD><TD><\/TD><TD><\/TD><TD PORT=\"FROM_wansink\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"publication_id_domain\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">publication_id_domain<\/TD><\/TR>\n    <TR><TD PORT=\"TO_publication_id\">publication_id<\/TD><TD PORT=\"FROM_publication_id\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_binary_outcome\">binary_outcome<\/TD><TD PORT=\"FROM_binary_outcome\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"publication_id_type_experiment\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">publication_id_type_experiment<\/TD><\/TR>\n    <TR><TD PORT=\"TO_publication_id\">publication_id<\/TD><TD PORT=\"FROM_publication_id\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_location\">location<\/TD><TD PORT=\"FROM_location\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_binary_outcome\">binary_outcome<\/TD><TD PORT=\"FROM_binary_outcome\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_approximation\">approximation<\/TD><TD PORT=\"FROM_approximation\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"study_id\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"2\">study_id<\/TD><\/TR>\n    <TR><TD PORT=\"TO_study_id\">study_id<\/TD><TD PORT=\"FROM_study_id\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_publication_id\">publication_id<\/TD><TD PORT=\"FROM_publication_id\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_domain\">domain<\/TD><TD PORT=\"FROM_domain\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_type_experiment\">type_experiment<\/TD><TD PORT=\"FROM_type_experiment\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_n_study\">n_study<\/TD><TD PORT=\"FROM_n_study\"><\/TD><\/TR>\n    <\/TABLE>>];\n\n  \"publication_id_domain\":FROM_publication_id -> \"publication_id\":TO_publication_id;\n  \"publication_id_type_experiment\":FROM_publication_id -> \"publication_id\":TO_publication_id;\n  \"es_id\":FROM_study_id -> \"study_id\":TO_study_id;\n  \"es_id\":FROM_intervention_technique -> \"intervention_technique\":TO_intervention_technique;\n  \"study_id\":FROM_publication_id -> \"publication_id_domain\":TO_publication_id;\n  \"study_id\":FROM_domain -> \"publication_id_domain\":TO_domain;\n  \"study_id\":FROM_publication_id -> \"publication_id_type_experiment\":TO_publication_id;\n  \"study_id\":FROM_type_experiment -> \"publication_id_type_experiment\":TO_type_experiment;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Questionable intermediate relations aside, we can see that there is
now a publication-level relation with the publication ID as a key, since
it determines the publication attributes once we remove one of the
duplicate records we discovered before.</p>
<p><code>reduce</code> can also be used on databases, where it considers
each relation with the largest number of records as a main table. It
needs to be used with caution: while the relations it removes are often
spurious, it’s possible to find databases where relations not linked to
the main relation by foreign key references are required to rejoin to
the original data frame, so reduction can remove necessary relations.
Its intent is mostly to make glancing at database plots more
manageable.</p>
</div>
<div class="section level3">
<h3 id="avoidable-attributes">Avoidable attributes<a class="anchor" aria-label="anchor" href="#avoidable-attributes"></a>
</h3>
<p>The next normal form after third normal form (3NF) is Boyes-Codd
normal form (BCNF). Ensuring BCNF is enforced by the database is
trickier, as in some cases it can’t be enforced with just relations and
foreign key constraints.</p>
<p>However, the package includes an option to convert to enhanced third
normal form, also known as LTK form, which can be so enforced. This
enhancement is tangential to BCNF, and could also be used to enhance
schemas in BCNF.</p>
<p>In brief, the standard normal forms only put constraints on the
attributes present in the relations one relation at a time. The
enhancement is a constraint on the attributes present in a relation,
while considering their presence in other relations. If a attribute in a
relation can be removed, and still be determined from that relation by
joining it to others, then the attribute is “avoidable”, and can be
removed. If the attribute is in any of the relation’s keys, they’ll be
replaced by keys that use the attributes not being removed. This removes
attributes from relations without removing any information from the
database as a whole.</p>
<p>For example, we can take this simple example from Chapter 6 of The
Theory of Relational Databases, by David Maier:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avoid_deps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/functional_dependency.html">functional_dependency</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"A"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span><span class="op">)</span>, <span class="st">"D"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span><span class="op">)</span>, <span class="st">"E"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"D"</span><span class="op">)</span>, <span class="st">"C"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  attrs_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">avoid_deps</span></span></code></pre></div>
<pre><code><span><span class="co">## 5 functional dependencies</span></span>
<span><span class="co">## 5 attributes: A, B, C, D, E</span></span>
<span><span class="co">##    A -&gt; B</span></span>
<span><span class="co">##    B -&gt; A</span></span>
<span><span class="co">## A, C -&gt; D</span></span>
<span><span class="co">## A, C -&gt; E</span></span>
<span><span class="co">## B, D -&gt; C</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avoid_schema</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalise.html">normalise</a></span><span class="op">(</span><span class="va">avoid_deps</span><span class="op">)</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">avoid_schema</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-3f27c09be0c60bb52829" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-3f27c09be0c60bb52829">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"A\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">A<\/TD><\/TR>\n    <TR><TD PORT=\"TO_a\">A<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_a\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_b\">B<\/TD><TD><\/TD><TD PORT=\"FROM_b\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"A_C\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">A_C<\/TD><\/TR>\n    <TR><TD PORT=\"TO_a\">A<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_a\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_c\">C<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_c\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_b\">B<\/TD><TD><\/TD><TD PORT=\"FROM_b\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_d\">D<\/TD><TD><\/TD><TD PORT=\"FROM_d\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_e\">E<\/TD><TD><\/TD><TD PORT=\"FROM_e\"><\/TD><\/TR>\n    <\/TABLE>>];\n\n  \"A_C\":FROM_a -> \"A\":TO_a;\n  \"A_C\":FROM_b -> \"A\":TO_b;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Attributes <code>A</code> and <code>B</code> are equivalent, since
relation <code>A</code> has them both as a key. In other words, relation
<code>A</code> is a simple lookup relation. Because of this, we could
remove <code>B</code> from relation <code>A_C</code>, and replace the
key <code>B, D</code> with <code>A, D</code>, which is equivalent when
accounting for relation <code>A</code>.</p>
<p>We can have this removal of avoidable attributes done automatically,
using the <code>remove_avoidable</code> flag for
<code>normalise</code>:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avoid_schema_removed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalise.html">normalise</a></span><span class="op">(</span></span>
<span>  <span class="va">avoid_deps</span>,</span>
<span>  remove_avoidable <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">avoid_schema_removed</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-416566eb193bf50d04e6" style="width:100%;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-416566eb193bf50d04e6">{"x":{"diagram":"digraph {\n  rankdir = \"LR\"\n  node [shape=plaintext];\n\n  \"A\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">A<\/TD><\/TR>\n    <TR><TD PORT=\"TO_a\">A<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_a\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_b\">B<\/TD><TD><\/TD><TD PORT=\"FROM_b\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <\/TABLE>>];\n  \"A_C\" [label = <\n    <TABLE BORDER=\"0\" CELLBORDER=\"1\" CELLSPACING=\"0\" CELLPADDING=\"4\">\n    <TR><TD COLSPAN=\"3\">A_C<\/TD><\/TR>\n    <TR><TD PORT=\"TO_a\">A<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_a\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_c\">C<\/TD><TD BGCOLOR=\"black\"><\/TD><TD PORT=\"FROM_c\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_d\">D<\/TD><TD><\/TD><TD PORT=\"FROM_d\" BGCOLOR=\"black\"><\/TD><\/TR>\n    <TR><TD PORT=\"TO_e\">E<\/TD><TD><\/TD><TD PORT=\"FROM_e\"><\/TD><\/TR>\n    <\/TABLE>>];\n\n  \"A_C\":FROM_a -> \"A\":TO_a;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>This schema is now in LTK form, with no remaining avoidable
attributes. We could have also removed <code>A</code> from relation
<code>A_C</code> instead of <code>B</code>, so this process may not have
a unique result. The package’s implementation prefers to remove
attributes that appear later in the original relation.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Webster.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
